<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Employee</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
 <!-- Include SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        {% with messages = get_flashed_messages(with_categories=True) %}
            {% if messages %}
                let messages = [];
                {% for category, message in messages %}
                    messages.push({icon: "{{ 'error' if category == 'danger' else 'success' }}", text: "{{ message }}"});
                {% endfor %}

                // Show the first message, then redirect
                if (messages.length > 0) {
                    Swal.fire({
                        icon: messages[0].icon,
                        title: messages[0].icon === 'success' ? "Success" : "Error",
                        text: messages[0].text,
                        confirmButtonColor: "#3085d6",
                        confirmButtonText: "OK"
                    }).then(() => {
                        {% if session.get('redirect_after_flash') %}
                            window.location.href = "{{ session.pop('redirect_after_flash') }}"; 
                        {% endif %}
                    });
                }
            {% endif %}
        {% endwith %}
    });
</script>
</head>
<body>
    <div class="container mt-5">
        <h2>Add Employee</h2>
        <form method="POST" action="{{ url_for('api.add_user') }}">
            {{ form.hidden_tag() }}
            <p>
                <label>First Name:</label>
                {{ form.first_name }}
            </p>
            <p>
                <label>Last Name:</label>
                {{ form.last_name }}
            </p>
            <p>
                <label>Email:</label>
                {{ form.email }}
            </p>
            <p>
                <label>Department:</label>
                {{ form.department }}
            </p>
            <p>
                <label>Joining Date:</label>
                {{ form.joining_date }}
            </p>
            <p>
                <label>Is Admin:</label>
                {{ form.is_admin}}
            </p>
            <input type="submit" value="Add Employee">
        </form>
    </div>
</body>
</html>